Return-Path: <io-uring+bounces-2140-lists+io-uring=lfdr.de@vger.kernel.org>
X-Original-To: lists+io-uring@lfdr.de
Delivered-To: lists+io-uring@lfdr.de
Received: from ny.mirrors.kernel.org (ny.mirrors.kernel.org [147.75.199.223])
	by mail.lfdr.de (Postfix) with ESMTPS id 8134A900B0E
	for <lists+io-uring@lfdr.de>; Fri,  7 Jun 2024 19:12:02 +0200 (CEST)
Received: from smtp.subspace.kernel.org (wormhole.subspace.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by ny.mirrors.kernel.org (Postfix) with ESMTPS id 85FAD1C213AF
	for <lists+io-uring@lfdr.de>; Fri,  7 Jun 2024 17:12:01 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id DBC9B19AA6D;
	Fri,  7 Jun 2024 17:11:57 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (2048-bit key) header.d=gmail.com header.i=@gmail.com header.b="EaFTFz9I"
X-Original-To: io-uring@vger.kernel.org
Received: from mail-yw1-f177.google.com (mail-yw1-f177.google.com [209.85.128.177])
	(using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 543D412B93;
	Fri,  7 Jun 2024 17:11:56 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=209.85.128.177
ARC-Seal:i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1717780317; cv=none; b=VRS9rbS25ZaON4SYgI9U7lWY8YYaEhGIJPc+5odPhEnfbkDKyDCsp+RHP88ASeRtInEPmycoxwxZvZyOpdriUgi0iOS0GNBsDqwU3cuXRTlXISOo4Ig9ewGFqtwEJfqtCEw+IWR3IAozeTiVwCsdHs572lMMtgmjKFvwQFigo+8=
ARC-Message-Signature:i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1717780317; c=relaxed/simple;
	bh=sZA/nGHjzHF5fR7FdNfjiNXQ9rhvbwi515U0+BEmtG4=;
	h=MIME-Version:From:Date:Message-ID:Subject:To:Content-Type; b=bQbI+2fmlwF8tSrsHH6Rljn6cjIRNJk3hfx8KjuhHC9dOSrioszQRsYO3jEmGOUyfikxOn6Li3aA7R2/WImPaTjtBDTTfBGrStSdoLb8JI2g4Q89+36UsXOgKKWw6ayQ5Q1crS4vLoPBibAcPmtzok0s7IiUyHBopBZuo62GAfo=
ARC-Authentication-Results:i=1; smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=gmail.com; spf=pass smtp.mailfrom=gmail.com; dkim=pass (2048-bit key) header.d=gmail.com header.i=@gmail.com header.b=EaFTFz9I; arc=none smtp.client-ip=209.85.128.177
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=gmail.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=gmail.com
Received: by mail-yw1-f177.google.com with SMTP id 00721157ae682-62c6317d15cso24199537b3.2;
        Fri, 07 Jun 2024 10:11:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20230601; t=1717780315; x=1718385115; darn=vger.kernel.org;
        h=to:subject:message-id:date:from:mime-version:from:to:cc:subject
         :date:message-id:reply-to;
        bh=xBzO44q2Xa0w6y86yZl4MXNQRVWa2cRMf88S1RXzUb0=;
        b=EaFTFz9IE/qeTwfrPFXhmDMaCKDMJ5E+K7Pg1eGWdoD1FxfigfVNUOdci4UYrLxtHJ
         pbIBNh9Pk3WhtdYLg59J8LJEWPiXUlbtvYqQHLrDwoWvwdQHyQdhYKSWgfUqd2VqL2v6
         Cf1Tft+VHA+Xzpu42bLhLev0kNsZWMsdFM6BkNm70bnGaua/93Uk5Das02xpnj1oMOGc
         AdXyMGeIhD2f+fpbMteG+tpLchuOTpW6zoACET9ToqM4Z2An4rhiSBC+T60ON8zihv+w
         EqiyDpQOniT+ukzfe/OSDQM19jKRJPWYH9xuNeS2rLVt3ziBTRUAll01YpvBV6m5UTp4
         fQdA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1717780315; x=1718385115;
        h=to:subject:message-id:date:from:mime-version:x-gm-message-state
         :from:to:cc:subject:date:message-id:reply-to;
        bh=xBzO44q2Xa0w6y86yZl4MXNQRVWa2cRMf88S1RXzUb0=;
        b=gS34pnSFHYG0pDiXQWN9zEEL1DJfOmAbq2ZWTfJCPVVsqbl/6d+yWax2PkF+OupQT1
         rOCwPbgemNugl5hsUe/lHSosWdUTzhYAaWiQLMAKYj8Z81Naf37umYqEAp1ZU4N32/d1
         pde3ZQaHTPifftaw3CG2mvZ34b8OEAVZYInBiIxL3IQQUbS3YMjb7PS2za5ophA0/aGd
         apd0IVZMJL9ELbm/epmaKqr0gJ9jKkroCze5rxGq7a7QJwtb74WF0/Lw2ZL+5V81hptR
         zTg4cPkPHJpE4Dq5QceFIcw4R2C0vbG4RNm6+zLl5S7G9MEC3OGDaRXnwVN2vadlhuXd
         eu1w==
X-Forwarded-Encrypted: i=1; AJvYcCWEZopMI2lxs00kwv7eH5Bbvw2jzdoB3ISjio8y6CvTvygPDYlQ10oKTzUjVWC4vL4IDTHXBk5OWIEUlLWM42JgwQmjiCUUQ2Q1xrz7zGhL3ghvW5n64HJIIXSV4dNOpa7qFXe1tGY=
X-Gm-Message-State: AOJu0YwHrIQJwgJlz8BOhySSqDRCBNB+91obBSCSlMryijvRMEq3SKnR
	Ykib0BJFD4Wgyb+9Ge4yDqkzxT7G4ojPdVBg6tTlqr6j6Z6ZZPYAXi3zViF5zkzzTFRHxiygeC/
	4jAkgIJK8IKzRgP/T96w/0nuMazZknOW8wU0=
X-Google-Smtp-Source: AGHT+IG/HXg60CBhYlWRQQusXY1YK5eGmxusSplMmC1/pkjBF7dXppB+H5ToqGuOaElF7tMbc+qB3LlIm/JU+XHIdCA=
X-Received: by 2002:a25:b01:0:b0:dfa:52bc:4981 with SMTP id
 3f1490d57ef6-dfaf65b1979mr2990643276.8.1717780315238; Fri, 07 Jun 2024
 10:11:55 -0700 (PDT)
Precedence: bulk
X-Mailing-List: io-uring@vger.kernel.org
List-Id: <io-uring.vger.kernel.org>
List-Subscribe: <mailto:io-uring+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:io-uring+unsubscribe@vger.kernel.org>
MIME-Version: 1.0
From: chase xd <sl1589472800@gmail.com>
Date: Fri, 7 Jun 2024 19:11:44 +0200
Message-ID: <CADZouDSJRVEHUK1dMQF-guuDh_EcMJE55uLYRR23M0a0gvkd=w@mail.gmail.com>
Subject: [io-uring] WARNING in io_rsrc_ref_quiesce
To: axboe@kernel.dk, asml.silence@gmail.com, io-uring@vger.kernel.org, 
	linux-kernel@vger.kernel.org
Content-Type: multipart/mixed; boundary="0000000000007e0948061a4fe5cc"

--0000000000007e0948061a4fe5cc
Content-Type: text/plain; charset="UTF-8"

Dear Linux kernel maintainers,

Syzkaller reports this previously unknown bug on Linux
6.8.0-rc3-00043-ga69d20885494-dirty #4. Seems like the bug was
silently or unintendedly fixed in the latest version.

```
------------[ cut here ]------------
do not call blocking ops when !TASK_RUNNING; state=1 set at
[<ffffffff815d2494>] prepare_to_wait+0xa4/0x380
kernel/sched/wait.c:237
WARNING: CPU: 2 PID: 397056 at kernel/sched/core.c:10099
__might_sleep+0x114/0x160 kernel/sched/core.c:10099
Modules linked in:
CPU: 2 PID: 397056 Comm: syz-executor.2 Not tainted
6.8.0-rc3-00043-ga69d20885494-dirty #50
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
RIP: 0010:__might_sleep+0x114/0x160 kernel/sched/core.c:10099
Code: 03 00 48 8d bb 50 17 00 00 48 89 fa 48 c1 ea 03 80 3c 02 00 75
37 48 8b 93 50 17 00 00 48 c7 c7 a0 55 0b 8a e8 9d d4 f4 ff 90 <0f> 0b
90 90 e9 71 ff ff ff e8 4e 28 78 00 e9 22 ff ff ff 89 34 24
RSP: 0018:ffffc9000bf5fb40 EFLAGS: 00010282
RAX: 0000000000000000 RBX: ffff888053524880 RCX: 0000000000000000
RDX: 0000000000000002 RSI: 0000000000000004 RDI: 0000000000000001
RBP: ffffffff8a0bc600 R08: 0000000000000001 R09: ffffed1017315171
R10: ffff8880b98a8b8b R11: 0000000000000000 R12: 0000000000000249
R13: 0000000000000000 R14: dffffc0000000000 R15: ffffc9000bf5fd20
FS:  00007fe4ffdcc640(0000) GS:ffff8880b9880000(0000) knlGS:0000000000000000
CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00007fa501ba3098 CR3: 0000000022b8c000 CR4: 0000000000750ef0
PKRU: 55555554
Call Trace:
 <TASK>
 __mutex_lock_common kernel/locking/mutex.c:585 [inline]
 __mutex_lock+0xb4/0x940 kernel/locking/mutex.c:752
 io_rsrc_ref_quiesce+0x590/0x940 io_uring/rsrc.c:253
 io_sqe_buffers_unregister+0xa2/0x340 io_uring/rsrc.c:799
 __io_uring_register io_uring/register.c:424 [inline]
 __do_sys_io_uring_register+0x5b9/0x2400 io_uring/register.c:613
 do_syscall_x64 arch/x86/entry/common.c:52 [inline]
 do_syscall_64+0xd8/0x270 arch/x86/entry/common.c:83
 entry_SYSCALL_64_after_hwframe+0x6f/0x77
RIP: 0033:0x7fe4ff0902ed
Code: c3 e8 97 2b 00 00 0f 1f 80 00 00 00 00 f3 0f 1e fa 48 89 f8 48
89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d
01 f0 ff ff 73 01 c3 48 c7 c1 b0 ff ff ff f7 d8 64 89 01 48
RSP: 002b:00007fe4ffdcc028 EFLAGS: 00000246 ORIG_RAX: 00000000000001ab
RAX: ffffffffffffffda RBX: 00007fe4ff1cbf80 RCX: 00007fe4ff0902ed
RDX: 0000000000000000 RSI: 0000000000000001 RDI: 0000000000000003
RBP: 00007fe4ff0f150e R08: 0000000000000000 R09: 0000000000000000
R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
R13: 000000000000000b R14: 00007fe4ff1cbf80 R15: 00007fe4ffdac000
 </TASK>

```

crepro is in the attachment.

Best Regards
Xdchase

--0000000000007e0948061a4fe5cc
Content-Type: application/octet-stream; name="repro.c"
Content-Disposition: attachment; filename="repro.c"
Content-Transfer-Encoding: base64
Content-ID: <f_lx4y0a630>
X-Attachment-Id: f_lx4y0a630

Ly8gYXV0b2dlbmVyYXRlZCBieSBzeXprYWxsZXIgKGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUv
c3l6a2FsbGVyKQoKI2RlZmluZSBfR05VX1NPVVJDRQoKI2luY2x1ZGUgPGRpcmVudC5oPgojaW5j
bHVkZSA8ZW5kaWFuLmg+CiNpbmNsdWRlIDxlcnJuby5oPgojaW5jbHVkZSA8ZmNudGwuaD4KI2lu
Y2x1ZGUgPHNpZ25hbC5oPgojaW5jbHVkZSA8c3RkYXJnLmg+CiNpbmNsdWRlIDxzdGRib29sLmg+
CiNpbmNsdWRlIDxzdGRpbnQuaD4KI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIu
aD4KI2luY2x1ZGUgPHN0cmluZy5oPgojaW5jbHVkZSA8c3lzL21tYW4uaD4KI2luY2x1ZGUgPHN5
cy9wcmN0bC5oPgojaW5jbHVkZSA8c3lzL3N0YXQuaD4KI2luY2x1ZGUgPHN5cy9zeXNjYWxsLmg+
CiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KI2luY2x1ZGUgPHN5cy93YWl0Lmg+CiNpbmNsdWRlIDx0
aW1lLmg+CiNpbmNsdWRlIDx1bmlzdGQuaD4KCiNpZm5kZWYgX19OUl9pb191cmluZ19lbnRlcgoj
ZGVmaW5lIF9fTlJfaW9fdXJpbmdfZW50ZXIgNDI2CiNlbmRpZgojaWZuZGVmIF9fTlJfaW9fdXJp
bmdfcmVnaXN0ZXIKI2RlZmluZSBfX05SX2lvX3VyaW5nX3JlZ2lzdGVyIDQyNwojZW5kaWYKI2lm
bmRlZiBfX05SX2lvX3VyaW5nX3NldHVwCiNkZWZpbmUgX19OUl9pb191cmluZ19zZXR1cCA0MjUK
I2VuZGlmCgpzdGF0aWMgdm9pZCBzbGVlcF9tcyh1aW50NjRfdCBtcykKewogIHVzbGVlcChtcyAq
IDEwMDApOwp9CgpzdGF0aWMgdWludDY0X3QgY3VycmVudF90aW1lX21zKHZvaWQpCnsKICBzdHJ1
Y3QgdGltZXNwZWMgdHM7CiAgaWYgKGNsb2NrX2dldHRpbWUoQ0xPQ0tfTU9OT1RPTklDLCAmdHMp
KQogICAgZXhpdCgxKTsKICByZXR1cm4gKHVpbnQ2NF90KXRzLnR2X3NlYyAqIDEwMDAgKyAodWlu
dDY0X3QpdHMudHZfbnNlYyAvIDEwMDAwMDA7Cn0KCnN0YXRpYyBib29sIHdyaXRlX2ZpbGUoY29u
c3QgY2hhciogZmlsZSwgY29uc3QgY2hhciogd2hhdCwgLi4uKQp7CiAgY2hhciBidWZbMTAyNF07
CiAgdmFfbGlzdCBhcmdzOwogIHZhX3N0YXJ0KGFyZ3MsIHdoYXQpOwogIHZzbnByaW50ZihidWYs
IHNpemVvZihidWYpLCB3aGF0LCBhcmdzKTsKICB2YV9lbmQoYXJncyk7CiAgYnVmW3NpemVvZihi
dWYpIC0gMV0gPSAwOwogIGludCBsZW4gPSBzdHJsZW4oYnVmKTsKICBpbnQgZmQgPSBvcGVuKGZp
bGUsIE9fV1JPTkxZIHwgT19DTE9FWEVDKTsKICBpZiAoZmQgPT0gLTEpCiAgICByZXR1cm4gZmFs
c2U7CiAgaWYgKHdyaXRlKGZkLCBidWYsIGxlbikgIT0gbGVuKSB7CiAgICBpbnQgZXJyID0gZXJy
bm87CiAgICBjbG9zZShmZCk7CiAgICBlcnJubyA9IGVycjsKICAgIHJldHVybiBmYWxzZTsKICB9
CiAgY2xvc2UoZmQpOwogIHJldHVybiB0cnVlOwp9CgojZGVmaW5lIFNJWkVPRl9JT19VUklOR19T
UUUgNjQKI2RlZmluZSBTSVpFT0ZfSU9fVVJJTkdfQ1FFIDE2CiNkZWZpbmUgU1FfSEVBRF9PRkZT
RVQgMAojZGVmaW5lIFNRX1RBSUxfT0ZGU0VUIDY0CiNkZWZpbmUgU1FfUklOR19NQVNLX09GRlNF
VCAyNTYKI2RlZmluZSBTUV9SSU5HX0VOVFJJRVNfT0ZGU0VUIDI2NAojZGVmaW5lIFNRX0ZMQUdT
X09GRlNFVCAyNzYKI2RlZmluZSBTUV9EUk9QUEVEX09GRlNFVCAyNzIKI2RlZmluZSBDUV9IRUFE
X09GRlNFVCAxMjgKI2RlZmluZSBDUV9UQUlMX09GRlNFVCAxOTIKI2RlZmluZSBDUV9SSU5HX01B
U0tfT0ZGU0VUIDI2MAojZGVmaW5lIENRX1JJTkdfRU5UUklFU19PRkZTRVQgMjY4CiNkZWZpbmUg
Q1FfUklOR19PVkVSRkxPV19PRkZTRVQgMjg0CiNkZWZpbmUgQ1FfRkxBR1NfT0ZGU0VUIDI4MAoj
ZGVmaW5lIENRX0NRRVNfT0ZGU0VUIDMyMAoKLy8gRnJvbSBsaW51eC9pb191cmluZy5oCnN0cnVj
dCBpb191cmluZ19jcWUgewogIHVpbnQ2NF90IHVzZXJfZGF0YTsKICB1aW50MzJfdCByZXM7CiAg
dWludDMyX3QgZmxhZ3M7Cn07CgovKiBUaGlzIGlzIHg4NiBzcGVjaWZpYyAqLwojZGVmaW5lIHJl
YWRfYmFycmllcigpIF9fYXNtX18gX192b2xhdGlsZV9fKCIiIDo6OiAibWVtb3J5IikKI2RlZmlu
ZSB3cml0ZV9iYXJyaWVyKCkgX19hc21fXyBfX3ZvbGF0aWxlX18oIiIgOjo6ICJtZW1vcnkiKQoK
c3RydWN0IGlvX3NxcmluZ19vZmZzZXRzIHsKICB1aW50MzJfdCBoZWFkOwogIHVpbnQzMl90IHRh
aWw7CiAgdWludDMyX3QgcmluZ19tYXNrOwogIHVpbnQzMl90IHJpbmdfZW50cmllczsKICB1aW50
MzJfdCBmbGFnczsKICB1aW50MzJfdCBkcm9wcGVkOwogIHVpbnQzMl90IGFycmF5OwogIHVpbnQz
Ml90IHJlc3YxOwogIHVpbnQ2NF90IHJlc3YyOwp9OwoKc3RydWN0IGlvX2NxcmluZ19vZmZzZXRz
IHsKICB1aW50MzJfdCBoZWFkOwogIHVpbnQzMl90IHRhaWw7CiAgdWludDMyX3QgcmluZ19tYXNr
OwogIHVpbnQzMl90IHJpbmdfZW50cmllczsKICB1aW50MzJfdCBvdmVyZmxvdzsKICB1aW50MzJf
dCBjcWVzOwogIHVpbnQ2NF90IHJlc3ZbMl07Cn07CgpzdHJ1Y3QgaW9fdXJpbmdfcGFyYW1zIHsK
ICB1aW50MzJfdCBzcV9lbnRyaWVzOwogIHVpbnQzMl90IGNxX2VudHJpZXM7CiAgdWludDMyX3Qg
ZmxhZ3M7CiAgdWludDMyX3Qgc3FfdGhyZWFkX2NwdTsKICB1aW50MzJfdCBzcV90aHJlYWRfaWRs
ZTsKICB1aW50MzJfdCBmZWF0dXJlczsKICB1aW50MzJfdCByZXN2WzRdOwogIHN0cnVjdCBpb19z
cXJpbmdfb2Zmc2V0cyBzcV9vZmY7CiAgc3RydWN0IGlvX2NxcmluZ19vZmZzZXRzIGNxX29mZjsK
fTsKCiNkZWZpbmUgSU9SSU5HX09GRl9TUV9SSU5HIDAKI2RlZmluZSBJT1JJTkdfT0ZGX1NRRVMg
MHgxMDAwMDAwMFVMTAojZGVmaW5lIElPUklOR19TRVRVUF9TUUUxMjggKDFVIDw8IDEwKQojZGVm
aW5lIElPUklOR19TRVRVUF9DUUUzMiAoMVUgPDwgMTEpCiNkZWZpbmUgSU9SSU5HX1NFVFVQX05P
X1NRQVJSQVkgKDFVIDw8IDE2KQoKc3RhdGljIHN0cnVjdCBpb191cmluZ19wYXJhbXMqIGlvX3Vy
aW5nX3A7CgpzdGF0aWMgbG9uZyBzeXpfaW9fdXJpbmdfY29tcGxldGUodm9sYXRpbGUgbG9uZyBh
MCwgdm9sYXRpbGUgbG9uZyBhMSkKewogIC8vIHN5emxhbmc6IHN5el9pb191cmluZ19jb21wbGV0
ZShyaW5nX3B0ciByaW5nX3B0cikKICAvLyBDOiAgICAgICBzeXpfaW9fdXJpbmdfY29tcGxldGUo
Y2hhciogcmluZ19wdHIpCiAgLy8gSXQgaXMgbm90IGNoZWNrZWQgaWYgdGhlIHJpbmcgaXMgZW1w
dHkKICAvLyBDYXN0IHRvIG9yaWdpbmFsCiAgbG9uZyByaW5nX3B0ciA9IGEwOwogIGludCogcmVz
dWx0X2ZkID0gKGludCopYTE7CiAgLy8gcmVzdWx0X2ZkID0gKGludCopbW1hcCgwLCBzaXplb2Yo
aW50KSAqIChpb191cmluZ19wLT5jcV9lbnRyaWVzKSwgUFJPVF9SRUFECiAgLy8gfCBQUk9UX1dS
SVRFLCBNQVBfU0hBUkVEIHwgTUFQX0FOT04sIC0xLCAwKTsgcmVzdWx0X2ZkX2NudCA9IChpbnQq
KW1tYXAoMCwKICAvLyBzaXplb2YoaW50KSwgUFJPVF9SRUFEIHwgUFJPVF9XUklURSwgTUFQX1NI
QVJFRCB8IE1BUF9BTk9OLCAtMSwgMCk7CiAgaW50IGNudCA9IDA7CiAgLy8gaGVhZCByZWFkIG9u
Y2UKICB1bnNpZ25lZCBjcV9oZWFkX3JhdyA9ICoodW5zaWduZWQqKShpb191cmluZ19wLT5jcV9v
ZmYuaGVhZCArIHJpbmdfcHRyKTsKICB1bnNpZ25lZCBjcV9yaW5nX21hc2sgPSAqKHVuc2lnbmVk
KikoaW9fdXJpbmdfcC0+Y3Ffb2ZmLnJpbmdfbWFzayArIHJpbmdfcHRyKTsKICBkbyB7CgogICAg
cmVhZF9iYXJyaWVyKCk7CiAgICAvLyB0YWlsCiAgICB1bnNpZ25lZCBjcV90YWlsX3JhdyA9ICoo
dW5zaWduZWQqKShpb191cmluZ19wLT5jcV9vZmYudGFpbCArIHJpbmdfcHRyKTsKICAgIGlmIChj
cV9oZWFkX3JhdyA9PSBjcV90YWlsX3JhdykgewogICAgICBicmVhazsKICAgIH0KICAgIC8vIGhl
YWQgIT0gdGFpbCwgcmV0cmlldmUgY3EgZnJvbSBoZWFkCiAgICB1bnNpZ25lZCBjcV9oZWFkID0g
Y3FfaGVhZF9yYXcgJiBjcV9yaW5nX21hc2s7CiAgICBzdHJ1Y3QgaW9fdXJpbmdfY3FlKiBjcWU7
CiAgICBpZiAoKGlvX3VyaW5nX3AtPmZsYWdzICYgSU9SSU5HX1NFVFVQX0NRRTMyKSA9PSAwKQog
ICAgICBjcWUgPSAoc3RydWN0IGlvX3VyaW5nX2NxZSopKGlvX3VyaW5nX3AtPmNxX29mZi5jcWVz
ICsgcmluZ19wdHIgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNJWkVPRl9J
T19VUklOR19DUUUgKiBjcV9oZWFkKTsKICAgIGVsc2UKICAgICAgY3FlID0gKHN0cnVjdCBpb191
cmluZ19jcWUqKShpb191cmluZ19wLT5jcV9vZmYuY3FlcyArIHJpbmdfcHRyICsKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBTSVpFT0ZfSU9fVVJJTkdfQ1FFICogMiAqIGNxX2hl
YWQpOwogICAgLy8gSW4gdGhlIGRlc2NyaXB0aW9ucyAoc3lzL2xpbnV4L2lvX3VyaW5nLnR4dCks
IG9wZW5hdCBhbmQgb3BlbmF0MiBhcmUKICAgIC8vIHBhc3NlZCB3aXRoIGEgdW5pcXVlIHJhbmdl
IG9mIHNxZS51c2VyX2RhdGEgKDB4MTIzNDUgYW5kIDB4MjM0NTYpIHRvCiAgICAvLyBpZGVudGlm
eSB0aGUgb3BlcmF0aW9ucyB3aGljaCBwcm9kdWNlcyBhbiBmZCBpbnN0YW5jZS4gQ2hlY2sKICAg
IC8vIGNxZS51c2VyX2RhdGEsIHdoaWNoIHNob3VsZCBiZSB0aGUgc2FtZSBhcyBzcWUudXNlcl9k
YXRhIGZvciB0aGF0CiAgICAvLyBvcGVyYXRpb24uIElmIGl0IGZhbGxzIGluIHRoYXQgdW5pcXVl
IHJhbmdlLCByZXR1cm4gY3FlLnJlcyBhcyBmZC4KICAgIC8vIE90aGVyd2lzZSwganVzdCByZXR1
cm4gYW4gaW52YWxpZCBmZC4KICAgIGlmIChjcWUtPnVzZXJfZGF0YSA9PSAweDEyMzQ1IHx8IGNx
ZS0+dXNlcl9kYXRhID09IDB4MjM0NTYpCiAgICAgIHJlc3VsdF9mZFtjbnQrK10gPSBjcWUtPnJl
czsKICAgIGNxX2hlYWRfcmF3ICs9IDE7CiAgfSB3aGlsZSAoMSk7CiAgKih1bnNpZ25lZCopKGlv
X3VyaW5nX3AtPmNxX29mZi5oZWFkICsgcmluZ19wdHIpID0gY3FfaGVhZF9yYXc7CiAgd3JpdGVf
YmFycmllcigpOwogIGlmIChjbnQgPT0gMCkgewogICAgcmV0dXJuIC0xOwogIH0KICByZXR1cm4g
MDsKfQoKLy8gV3JhcHBlciBmb3IgaW9fdXJpbmdfc2V0dXAgYW5kIHRoZSBzdWJzZXF1ZW50IG1t
YXAgY2FsbHMgdGhhdCBtYXAgdGhlIHJpbmcKLy8gYW5kIHRoZSBzcWVzCnN0YXRpYyBsb25nIHN5
el9pb191cmluZ19zZXR1cCh2b2xhdGlsZSBsb25nIGEwLCB2b2xhdGlsZSBsb25nIGExLAogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9sYXRpbGUgbG9uZyBhMiwgdm9sYXRpbGUgbG9u
ZyBhMykKewogIC8vIHN5emxhbmc6IHN5el9pb191cmluZ19zZXR1cChlbnRyaWVzIGludDMyWzE6
SU9SSU5HX01BWF9FTlRSSUVTXSwgcGFyYW1zCiAgLy8gcHRyW2lub3V0LCBpb191cmluZ19wYXJh
bXNdLCByaW5nX3B0ciBwdHJbb3V0LCByaW5nX3B0cl0sIHNxZXNfcHRyIHB0cltvdXQsCiAgLy8g
c3Flc19wdHJdKSBmZF9pb191cmluZyBDOiAgICAgICBzeXpfaW9fdXJpbmdfc2V0dXAodWludDMy
X3QgZW50cmllcywgc3RydWN0CiAgLy8gaW9fdXJpbmdfcGFyYW1zKiBwYXJhbXMsIHZvaWQqKiBy
aW5nX3B0cl9vdXQsIHZvaWQqKiBzcWVzX3B0cl9vdXQpIC8vCiAgLy8gcmV0dXJucyB1aW50MzJf
dCBmZF9pb191cmluZyBDYXN0IHRvIG9yaWdpbmFsCiAgdWludDMyX3QgZW50cmllcyA9ICh1aW50
MzJfdClhMDsKICBzdHJ1Y3QgaW9fdXJpbmdfcGFyYW1zKiBzZXR1cF9wYXJhbXMgPSAoc3RydWN0
IGlvX3VyaW5nX3BhcmFtcyopYTE7CiAgdm9pZCoqIHJpbmdfcHRyX291dCA9ICh2b2lkKiopYTI7
CiAgdm9pZCoqIHNxZXNfcHRyX291dCA9ICh2b2lkKiopYTM7CiAgLy8gVGVtcG9yYXJpbHkgZGlz
YWJsZSBJT1JJTkdfU0VUVVBfQ1FFMzIgYW5kIElPUklOR19TRVRVUF9TUUUxMjggdGhhdCBtYXkK
ICAvLyBjaGFuZ2UgU0laRU9GX0lPX1VSSU5HX0NRRSBhbmQgU0laRU9GX0lPX1VSSU5HX1NRRS4g
VHJhY2tpbmcgYnVnOgogIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nb29nbGUvc3l6a2FsbGVyL2lz
c3Vlcy80NTMxLgogIHNldHVwX3BhcmFtcy0+ZmxhZ3MgJj0gfihJT1JJTkdfU0VUVVBfQ1FFMzIg
fCBJT1JJTkdfU0VUVVBfU1FFMTI4KTsKICB1aW50MzJfdCBmZF9pb191cmluZyA9IHN5c2NhbGwo
X19OUl9pb191cmluZ19zZXR1cCwgZW50cmllcywgc2V0dXBfcGFyYW1zKTsKICBpb191cmluZ19w
ID0gc2V0dXBfcGFyYW1zOwogIC8vIENvbXB1dGUgdGhlIHJpbmcgc2l6ZXMKICB1aW50MzJfdCBz
cV9yaW5nX3N6ID0KICAgICAgc2V0dXBfcGFyYW1zLT5zcV9vZmYuYXJyYXkgKyBzZXR1cF9wYXJh
bXMtPnNxX2VudHJpZXMgKiBzaXplb2YodWludDMyX3QpOwogIHVpbnQzMl90IGNxX3Jpbmdfc3og
PSBzZXR1cF9wYXJhbXMtPmNxX29mZi5jcWVzICsKICAgICAgICAgICAgICAgICAgICAgICAgc2V0
dXBfcGFyYW1zLT5jcV9lbnRyaWVzICogU0laRU9GX0lPX1VSSU5HX0NRRTsKICAvLyBBc3NzdW1l
ZCBJT1JJTkdfRkVBVF9TSU5HTEVfTU1BUCwgd2hpY2ggaXMgYWx3YXlzIHRoZSBjYXNlIHdpdGgg
dGhlIGN1cnJlbnQKICAvLyBpbXBsZW1lbnRhdGlvbiBUaGUgaW1wbGljYXRpb24gaXMgdGhhdCB0
aGUgc3FfcmluZ19wdHIgYW5kIHRoZSBjcV9yaW5nX3B0cgogIC8vIGFyZSB0aGUgc2FtZSBidXQg
dGhlIGRpZmZlcmVuY2UgaXMgaW4gdGhlIG9mZnNldHMgdG8gYWNjZXNzIHRoZSBmaWVsZHMgb2YK
ICAvLyB0aGVzZSByaW5ncy4KICB1aW50MzJfdCByaW5nX3N6ID0gc3FfcmluZ19zeiA+IGNxX3Jp
bmdfc3ogPyBzcV9yaW5nX3N6IDogY3FfcmluZ19zejsKICAqcmluZ19wdHJfb3V0ID0KICAgICAg
bW1hcCgwLCByaW5nX3N6LCBQUk9UX1JFQUQgfCBQUk9UX1dSSVRFLCBNQVBfU0hBUkVEIHwgTUFQ
X1BPUFVMQVRFLAogICAgICAgICAgIGZkX2lvX3VyaW5nLCBJT1JJTkdfT0ZGX1NRX1JJTkcpOwog
IHVpbnQzMl90IHNxZXNfc3ogPSBzZXR1cF9wYXJhbXMtPnNxX2VudHJpZXMgKiBTSVpFT0ZfSU9f
VVJJTkdfU1FFOwogICpzcWVzX3B0cl9vdXQgPSBtbWFwKDAsIHNxZXNfc3osIFBST1RfUkVBRCB8
IFBST1RfV1JJVEUsCiAgICAgICAgICAgICAgICAgICAgICAgTUFQX1NIQVJFRCB8IE1BUF9QT1BV
TEFURSwgZmRfaW9fdXJpbmcsIElPUklOR19PRkZfU1FFUyk7CiAgcmV0dXJuIGZkX2lvX3VyaW5n
Owp9CgpzdGF0aWMgbG9uZyBzeXpfaW9fdXJpbmdfc3VibWl0KHZvbGF0aWxlIGxvbmcgYTAsIHZv
bGF0aWxlIGxvbmcgYTEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9sYXRpbGUg
bG9uZyBhMikKewogIC8vIHN5emxhbmc6IHN5el9pb191cmluZ19zdWJtaXQocmluZ19wdHIgcmlu
Z19wdHIsIHNxZXNfcHRyIHNxZXNfcHRyLAogIC8vIHNxZSBwdHJbaW4sIGlvX3VyaW5nX3NxZV0p
IEM6ICAgICAgIHN5el9pb191cmluZ19zdWJtaXQoY2hhciogcmluZ19wdHIsCiAgLy8gaW9fdXJp
bmdfc3FlKiBzcWVzX3B0ciwgICAgaW9fdXJpbmdfc3FlKiBzcWUpIEl0IGlzIG5vdCBjaGVja2Vk
IGlmIHRoZSByaW5nCiAgLy8gaXMgZnVsbCBDYXN0IHRvIG9yaWdpbmFsCiAgbG9uZyByaW5nX3B0
ciA9IGEwOyAvLyBUaGlzIHdpbGwgYmUgZXhwb3NlZCB0byBvZmZzZXRzIGluIGJ5dGVzCiAgY2hh
ciogc3Flc19wdHIgPSAoY2hhciopYTE7CiAgY2hhciogc3FlID0gKGNoYXIqKWEyOwogIHVuc2ln
bmVkIHNxX3RhaWxfcmF3ID0gKih1bnNpZ25lZCopKGlvX3VyaW5nX3AtPnNxX29mZi50YWlsICsg
cmluZ19wdHIpOwogIHVuc2lnbmVkIHNxX3JpbmdfbWFzayA9ICoodW5zaWduZWQqKShpb191cmlu
Z19wLT5zcV9vZmYucmluZ19tYXNrICsgcmluZ19wdHIpOwogIHVuc2lnbmVkIHNxX3RhaWwgPSBz
cV90YWlsX3JhdyAmIHNxX3JpbmdfbWFzazsKICAvLyB3cml0ZSB0byBjdXJyZW50IHNxIHRhaWwg
c3FlCiAgdm9pZCogc3FlX2Rlc3Q7CiAgaWYgKChpb191cmluZ19wLT5mbGFncyAmIElPUklOR19T
RVRVUF9TUUUxMjgpID09IDApCiAgICBzcWVfZGVzdCA9ICh2b2lkKikoc3Flc19wdHIgKyBTSVpF
T0ZfSU9fVVJJTkdfU1FFICogc3FfdGFpbCk7CiAgZWxzZSB7CiAgICBzcWVfZGVzdCA9ICh2b2lk
Kikoc3Flc19wdHIgKyBTSVpFT0ZfSU9fVVJJTkdfU1FFICogc3FfdGFpbCAqIDIpOwogIH0KCiAg
Ly8gV3JpdGUgdGhlIHNxZSBlbnRyeSB0byBpdHMgZGVzdGluYXRpb24gaW4gc3FlcwogIG1lbWNw
eShzcWVfZGVzdCwgc3FlLCBTSVpFT0ZfSU9fVVJJTkdfU1FFKTsKICAvLyBBZHZhbmNlIHRoZSB0
YWlsLiBUYWlsIGlzIGEgZnJlZS1mbG93aW5nIGludGVnZXIgYW5kIHJlbGllcyBvbiBuYXR1cmFs
CiAgLy8gd3JhcHBpbmcuIEVuc3VyZSB0aGF0IHRoZSBrZXJuZWwgd2lsbCBuZXZlciBzZWUgYSB0
YWlsIHVwZGF0ZSB3aXRob3V0IHRoZQogIC8vIHByZWNlZWRpbmcgU1FFIHN0b3JlcyBiZWluZyBk
b25lLgogIF9fYXRvbWljX3N0b3JlX24oKHVuc2lnbmVkKikoaW9fdXJpbmdfcC0+c3Ffb2ZmLnRh
aWwgKyByaW5nX3B0ciksCiAgICAgICAgICAgICAgICAgICBzcV90YWlsX3JhdyArIDEsIF9fQVRP
TUlDX1JFTEVBU0UpOwogIC8vIHVwZGF0ZSBzcSBhcnJheQogIGlmICgoaW9fdXJpbmdfcC0+Zmxh
Z3MgJiBJT1JJTkdfU0VUVVBfTk9fU1FBUlJBWSkgPT0gMCkKICAgIF9fYXRvbWljX3N0b3JlX24o
KHVuc2lnbmVkKikoaW9fdXJpbmdfcC0+c3Ffb2ZmLmFycmF5ICsgcmluZ19wdHIpICsgc3FfdGFp
bCwKICAgICAgICAgICAgICAgICAgICAgc3FfdGFpbCwgX19BVE9NSUNfUkVMRUFTRSk7CiAgLy8g
Tm93IHRoZSBhcHBsaWNhdGlvbiBpcyBmcmVlIHRvIGNhbGwgaW9fdXJpbmdfZW50ZXIoKSB0byBz
dWJtaXQgdGhlIHNxZQogIHJldHVybiAwOwp9CgpzdGF0aWMgdm9pZCBraWxsX2FuZF93YWl0KGlu
dCBwaWQsIGludCogc3RhdHVzKQp7CiAga2lsbCgtcGlkLCBTSUdLSUxMKTsKICBraWxsKHBpZCwg
U0lHS0lMTCk7CiAgZm9yIChpbnQgaSA9IDA7IGkgPCAxMDA7IGkrKykgewogICAgaWYgKHdhaXRw
aWQoLTEsIHN0YXR1cywgV05PSEFORyB8IF9fV0FMTCkgPT0gcGlkKQogICAgICByZXR1cm47CiAg
ICB1c2xlZXAoMTAwMCk7CiAgfQogIERJUiogZGlyID0gb3BlbmRpcigiL3N5cy9mcy9mdXNlL2Nv
bm5lY3Rpb25zIik7CiAgaWYgKGRpcikgewogICAgZm9yICg7OykgewogICAgICBzdHJ1Y3QgZGly
ZW50KiBlbnQgPSByZWFkZGlyKGRpcik7CiAgICAgIGlmICghZW50KQogICAgICAgIGJyZWFrOwog
ICAgICBpZiAoc3RyY21wKGVudC0+ZF9uYW1lLCAiLiIpID09IDAgfHwgc3RyY21wKGVudC0+ZF9u
YW1lLCAiLi4iKSA9PSAwKQogICAgICAgIGNvbnRpbnVlOwogICAgICBjaGFyIGFib3J0WzMwMF07
CiAgICAgIHNucHJpbnRmKGFib3J0LCBzaXplb2YoYWJvcnQpLCAiL3N5cy9mcy9mdXNlL2Nvbm5l
Y3Rpb25zLyVzL2Fib3J0IiwKICAgICAgICAgICAgICAgZW50LT5kX25hbWUpOwogICAgICBpbnQg
ZmQgPSBvcGVuKGFib3J0LCBPX1dST05MWSk7CiAgICAgIGlmIChmZCA9PSAtMSkgewogICAgICAg
IGNvbnRpbnVlOwogICAgICB9CiAgICAgIGlmICh3cml0ZShmZCwgYWJvcnQsIDEpIDwgMCkgewog
ICAgICB9CiAgICAgIGNsb3NlKGZkKTsKICAgIH0KICAgIGNsb3NlZGlyKGRpcik7CiAgfSBlbHNl
IHsKICB9CiAgd2hpbGUgKHdhaXRwaWQoLTEsIHN0YXR1cywgX19XQUxMKSAhPSBwaWQpIHsKICB9
Cn0KCnN0YXRpYyB2b2lkIHNldHVwX3Rlc3QoKQp7CiAgcHJjdGwoUFJfU0VUX1BERUFUSFNJRywg
U0lHS0lMTCwgMCwgMCwgMCk7CiAgc2V0cGdycCgpOwogIHdyaXRlX2ZpbGUoIi9wcm9jL3NlbGYv
b29tX3Njb3JlX2FkaiIsICIxMDAwIik7Cn0KCnN0YXRpYyB2b2lkIGV4ZWN1dGVfb25lKHZvaWQp
OwoKI2RlZmluZSBXQUlUX0ZMQUdTIF9fV0FMTAoKc3RhdGljIHZvaWQgbG9vcCh2b2lkKQp7CiAg
aW50IGl0ZXIgPSAwOwogIGZvciAoOzsgaXRlcisrKSB7CiAgICBpbnQgcGlkID0gZm9yaygpOwog
ICAgaWYgKHBpZCA8IDApCiAgICAgIGV4aXQoMSk7CiAgICBpZiAocGlkID09IDApIHsKICAgICAg
c2V0dXBfdGVzdCgpOwogICAgICBleGVjdXRlX29uZSgpOwogICAgICBleGl0KDApOwogICAgfQog
ICAgaW50IHN0YXR1cyA9IDA7CiAgICB1aW50NjRfdCBzdGFydCA9IGN1cnJlbnRfdGltZV9tcygp
OwogICAgZm9yICg7OykgewogICAgICBpZiAod2FpdHBpZCgtMSwgJnN0YXR1cywgV05PSEFORyB8
IFdBSVRfRkxBR1MpID09IHBpZCkKICAgICAgICBicmVhazsKICAgICAgc2xlZXBfbXMoMSk7CiAg
ICAgIGlmIChjdXJyZW50X3RpbWVfbXMoKSAtIHN0YXJ0IDwgNTAwMCkKICAgICAgICBjb250aW51
ZTsKICAgICAga2lsbF9hbmRfd2FpdChwaWQsICZzdGF0dXMpOwogICAgICBicmVhazsKICAgIH0K
ICB9Cn0KCnVpbnQ2NF90IHJbNV0gPSB7MHgwLCAweDAsIDB4MCwgMHhmZmZmZmZmZmZmZmZmZmZm
LCAweDB9OwoKdm9pZCBleGVjdXRlX29uZSh2b2lkKQp7CiAgaW50cHRyX3QgcmVzID0gMDsKICAq
KHVpbnQzMl90KikweDIwMDAwMDA0ID0gMHgxZWQyOwogICoodWludDMyX3QqKTB4MjAwMDAwMDgg
PSAwOwogICoodWludDMyX3QqKTB4MjAwMDAwMGMgPSAxOwogICoodWludDMyX3QqKTB4MjAwMDAw
MTAgPSAweDM2NzsKICAqKHVpbnQzMl90KikweDIwMDAwMDE4ID0gMDsKICBtZW1zZXQoKHZvaWQq
KTB4MjAwMDAwMWMsIDAsIDEyKTsKICByZXMgPSAtMTsKICByZXMgPSBzeXpfaW9fdXJpbmdfc2V0
dXAoLyplbnRyaWVzPSovMHgyOWYzLCAvKnBhcmFtcz0qLzB4MjAwMDAwMDAsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgIC8qcmluZ19wdHI9Ki8weDIwMDAwMDgwLCAvKnNxZXNfcHRyPSovMHgy
MDAwMDBjMCk7CiAgaWYgKHJlcyAhPSAtMSkgewogICAgclswXSA9IHJlczsKICAgIHJbMV0gPSAq
KHVpbnQ2NF90KikweDIwMDAwMDgwOwogICAgclsyXSA9ICoodWludDY0X3QqKTB4MjAwMDAwYzA7
CiAgfQogIHJlcyA9IHN5c2NhbGwoX19OUl9vcGVuLCAvKmZpbGU9Ki8wdWwsIC8qZmxhZ3M9T19T
WU5DfE9fUkRXUiovIDB4MTAxMDAydWwsCiAgICAgICAgICAgICAgICAvKm1vZGU9U19JUk9USHxT
X0lXVVNSKi8gMHg4NHVsKTsKICBpZiAocmVzICE9IC0xKQogICAgclszXSA9IHJlczsKICBzeXNj
YWxsKF9fTlJfb3BlbiwgLypmaWxlPSovMHVsLAogICAgICAgICAgLypmbGFncz1fX09fVE1QRklM
RXxPX05PQVRJTUV8T19XUk9OTFkqLyAweDQ0MDAwMXVsLAogICAgICAgICAgLyptb2RlPVNfSVhH
UlB8U19JV0dSUHxTX0lYVVNSfFNfSVJVU1IqLyAweDE1OHVsKTsKICByZXMgPSBzeXNjYWxsKF9f
TlJfc29ja2V0LCAvKmRvbWFpbj1BRl9SRFMqLyAweDE1dWwsIC8qdHlwZT1TT0NLX1NUUkVBTSov
IDF1bCwKICAgICAgICAgICAgICAgIC8qcHJvdG89Ki8weDg5NCk7CiAgaWYgKHJlcyAhPSAtMSkK
ICAgIHJbNF0gPSByZXM7CiAgc3lzY2FsbChfX05SX2Vwb2xsX2NyZWF0ZTEsIC8qZmxhZ3M9Ki8w
dWwpOwogIHN5c2NhbGwoX19OUl9ldmVudGZkMiwgLyppbml0dmFsPSovOCwKICAgICAgICAgIC8q
ZmxhZ3M9RUZEX05PTkJMT0NLfEVGRF9DTE9FWEVDKi8gMHg4MDgwMHVsKTsKICAqKHVpbnQ2NF90
KikweDIwMDAwMzQwID0gMDsKICAqKHVpbnQ2NF90KikweDIwMDAwMzQ4ID0gMDsKICAqKHVpbnQ2
NF90KikweDIwMDAwMzUwID0gMDsKICAqKHVpbnQ2NF90KikweDIwMDAwMzU4ID0gMDsKICBzeXNj
YWxsKF9fTlJfaW9fdXJpbmdfcmVnaXN0ZXIsIC8qZmQ9Ki9yWzBdLCAvKm9wY29kZT0qLzB1bCwK
ICAgICAgICAgIC8qYXJnPSovMHgyMDAwMDM0MHVsLCAvKm5yX2FyZ3M9Ki8ydWwpOwogIHN5c2Nh
bGwoX19OUl9jbG9ja19nZXR0aW1lLCAvKmlkPSovMHVsLCAvKnRwPSovMHVsKTsKICBzeXNjYWxs
KF9fTlJfY2xvY2tfZ2V0dGltZSwgLyppZD0qLzB1bCwgLyp0cD0qLzB1bCk7CiAgKih1aW50OF90
KikweDIwMDAwMzgwID0gMHgyMTsKICAqKHVpbnQ4X3QqKTB4MjAwMDAzODEgPSAweDFjOwogICoo
dWludDE2X3QqKTB4MjAwMDAzODIgPSAwOwogICoodWludDMyX3QqKTB4MjAwMDAzODQgPSByWzNd
OwogICoodWludDY0X3QqKTB4MjAwMDAzODggPSAwOwogICoodWludDY0X3QqKTB4MjAwMDAzOTAg
PSAwOwogICoodWludDMyX3QqKTB4MjAwMDAzOTggPSAzOwogICoodWludDMyX3QqKTB4MjAwMDAz
OWMgPSA4OwogICoodWludDY0X3QqKTB4MjAwMDAzYTAgPSAwOwogICoodWludDE2X3QqKTB4MjAw
MDAzYTggPSAwOwogICoodWludDE2X3QqKTB4MjAwMDAzYWEgPSAwOwogICoodWludDMyX3QqKTB4
MjAwMDAzYWMgPSByWzNdOwogIG1lbXNldCgodm9pZCopMHgyMDAwMDNiMCwgMCwgMTYpOwogIHN5
el9pb191cmluZ19zdWJtaXQoLypyaW5nX3B0cj0qL3JbMV0sIC8qc3Flc19wdHI9Ki9yWzJdLCAv
KnNxZT0qLzB4MjAwMDAzODApOwogICoodWludDhfdCopMHgyMDAwMDQ0MCA9IDB4YjsKICAqKHVp
bnQ4X3QqKTB4MjAwMDA0NDEgPSAweDEwOwogICoodWludDE2X3QqKTB4MjAwMDA0NDIgPSAwOwog
ICoodWludDMyX3QqKTB4MjAwMDA0NDQgPSAwOwogICoodWludDY0X3QqKTB4MjAwMDA0NDggPSA0
OwogICoodWludDY0X3QqKTB4MjAwMDA0NTAgPSAweDIwMDAwNDAwOwogICoodWludDY0X3QqKTB4
MjAwMDA0MDAgPSAwOwogICoodWludDY0X3QqKTB4MjAwMDA0MDggPSAwOwogICoodWludDMyX3Qq
KTB4MjAwMDA0NTggPSAxOwogICoodWludDMyX3QqKTB4MjAwMDA0NWMgPSAxOwogICoodWludDY0
X3QqKTB4MjAwMDA0NjAgPSAxOwogICoodWludDE2X3QqKTB4MjAwMDA0NjggPSAwOwogICoodWlu
dDE2X3QqKTB4MjAwMDA0NmEgPSAwOwogIG1lbXNldCgodm9pZCopMHgyMDAwMDQ2YywgMCwgNCk7
CiAgbWVtc2V0KCh2b2lkKikweDIwMDAwNDcwLCAwLCAxNik7CiAgc3l6X2lvX3VyaW5nX3N1Ym1p
dCgvKnJpbmdfcHRyPSovclsxXSwgLypzcWVzX3B0cj0qL3JbMl0sIC8qc3FlPSovMHgyMDAwMDQ0
MCk7CiAgKih1aW50OF90KikweDIwMDAxNzgwID0gOTsKICAqKHVpbnQ4X3QqKTB4MjAwMDE3ODEg
PSAweGU7CiAgKih1aW50MTZfdCopMHgyMDAwMTc4MiA9IDA7CiAgKih1aW50MzJfdCopMHgyMDAw
MTc4NCA9IHJbNF07CiAgKih1aW50NjRfdCopMHgyMDAwMTc4OCA9IDA7CiAgKih1aW50NjRfdCop
MHgyMDAwMTc5MCA9IDB4MjAwMDE3NDA7CiAgKih1aW50NjRfdCopMHgyMDAwMTc0MCA9IDA7CiAg
Kih1aW50MzJfdCopMHgyMDAwMTc0OCA9IDA7CiAgKih1aW50NjRfdCopMHgyMDAwMTc1MCA9IDA7
CiAgKih1aW50NjRfdCopMHgyMDAwMTc1OCA9IDA7CiAgKih1aW50NjRfdCopMHgyMDAwMTc2MCA9
IDA7CiAgKih1aW50NjRfdCopMHgyMDAwMTc2OCA9IDA7CiAgKih1aW50MzJfdCopMHgyMDAwMTc3
MCA9IDA7CiAgKih1aW50MzJfdCopMHgyMDAwMTc5OCA9IDc7CiAgKih1aW50MzJfdCopMHgyMDAw
MTc5YyA9IDB4ODA7CiAgKih1aW50NjRfdCopMHgyMDAwMTdhMCA9IDE7CiAgKih1aW50MTZfdCop
MHgyMDAwMTdhOCA9IDA7CiAgKih1aW50MTZfdCopMHgyMDAwMTdhYSA9IDA7CiAgbWVtc2V0KCh2
b2lkKikweDIwMDAxN2FjLCAwLCA0KTsKICBtZW1zZXQoKHZvaWQqKTB4MjAwMDE3YjAsIDAsIDE2
KTsKICBzeXpfaW9fdXJpbmdfc3VibWl0KC8qcmluZ19wdHI9Ki9yWzFdLCAvKnNxZXNfcHRyPSov
clsyXSwgLypzcWU9Ki8weDIwMDAxNzgwKTsKICAqKHVpbnQ4X3QqKTB4MjAwMDE4ODAgPSA1Owog
ICoodWludDhfdCopMHgyMDAwMTg4MSA9IDE7CiAgKih1aW50MTZfdCopMHgyMDAwMTg4MiA9IDB4
MjAwNzsKICAqKHVpbnQzMl90KikweDIwMDAxODg0ID0gclszXTsKICAqKHVpbnQ2NF90KikweDIw
MDAxODg4ID0gMHg3ZmZmOwogICoodWludDY0X3QqKTB4MjAwMDE4OTAgPSAwOwogICoodWludDMy
X3QqKTB4MjAwMDE4OTggPSAwOwogICoodWludDMyX3QqKTB4MjAwMDE4OWMgPSAweGE7CiAgKih1
aW50NjRfdCopMHgyMDAwMThhMCA9IDA7CiAgKih1aW50MTZfdCopMHgyMDAwMThhOCA9IDA7CiAg
Kih1aW50MTZfdCopMHgyMDAwMThhYSA9IDA7CiAgbWVtc2V0KCh2b2lkKikweDIwMDAxOGFjLCAw
LCA0KTsKICBtZW1zZXQoKHZvaWQqKTB4MjAwMDE4YjAsIDAsIDE2KTsKICBzeXpfaW9fdXJpbmdf
c3VibWl0KC8qcmluZ19wdHI9Ki9yWzFdLCAvKnNxZXNfcHRyPSovclsyXSwgLypzcWU9Ki8weDIw
MDAxODgwKTsKICAqKHVpbnQ4X3QqKTB4MjAwMDE5MDAgPSA3OwogICoodWludDhfdCopMHgyMDAw
MTkwMSA9IDB4YzsKICAqKHVpbnQxNl90KikweDIwMDAxOTAyID0gMDsKICAqKHVpbnQzMl90Kikw
eDIwMDAxOTA0ID0gclszXTsKICAqKHVpbnQ2NF90KikweDIwMDAxOTA4ID0gMHg5OTM7CiAgKih1
aW50NjRfdCopMHgyMDAwMTkxMCA9IDI7CiAgKih1aW50MTZfdCopMHgyMDAwMTkxOCA9IDQ7CiAg
Kih1aW50MzJfdCopMHgyMDAwMTkxYyA9IDA7CiAgKih1aW50NjRfdCopMHgyMDAwMTkyMCA9IDA7
CiAgKih1aW50MTZfdCopMHgyMDAwMTkyOCA9IDA7CiAgKih1aW50MTZfdCopMHgyMDAwMTkyYSA9
IDA7CiAgbWVtc2V0KCh2b2lkKikweDIwMDAxOTJjLCAwLCA0KTsKICBtZW1zZXQoKHZvaWQqKTB4
MjAwMDE5MzAsIDAsIDE2KTsKICBzeXpfaW9fdXJpbmdfc3VibWl0KC8qcmluZ19wdHI9Ki9yWzFd
LCAvKnNxZXNfcHRyPSovclsyXSwgLypzcWU9Ki8weDIwMDAxOTAwKTsKICAqKHVpbnQ4X3QqKTB4
MjAwMDE5ODAgPSA3OwogICoodWludDhfdCopMHgyMDAwMTk4MSA9IDM7CiAgKih1aW50MTZfdCop
MHgyMDAwMTk4MiA9IDA7CiAgKih1aW50MzJfdCopMHgyMDAwMTk4NCA9IHJbM107CiAgKih1aW50
NjRfdCopMHgyMDAwMTk4OCA9IC0xOwogICoodWludDY0X3QqKTB4MjAwMDE5OTAgPSA5OwogICoo
dWludDE2X3QqKTB4MjAwMDE5OTggPSAxOwogICoodWludDMyX3QqKTB4MjAwMDE5OWMgPSAwOwog
ICoodWludDY0X3QqKTB4MjAwMDE5YTAgPSAwOwogICoodWludDE2X3QqKTB4MjAwMDE5YTggPSAw
OwogICoodWludDE2X3QqKTB4MjAwMDE5YWEgPSAwOwogIG1lbXNldCgodm9pZCopMHgyMDAwMTlh
YywgMCwgNCk7CiAgbWVtc2V0KCh2b2lkKikweDIwMDAxOWIwLCAwLCAxNik7CiAgc3l6X2lvX3Vy
aW5nX3N1Ym1pdCgvKnJpbmdfcHRyPSovclsxXSwgLypzcWVzX3B0cj0qL3JbMl0sIC8qc3FlPSov
MHgyMDAwMTk4MCk7CiAgc3lzY2FsbChfX05SX2lvX3VyaW5nX2VudGVyLCAvKmZkPSovclswXSwg
Lyp0b19zdWJtaXQ9Ki82LCAvKm1pbl9jb21wbGV0ZT0qLzYsCiAgICAgICAgICAvKmZsYWdzPUlP
UklOR19FTlRFUl9HRVRFVkVOVFMqLyAxdWwsIC8qc2lnbWFzaz0qLzB1bCwgLypzaXplPSovMHVs
KTsKICBzeXpfaW9fdXJpbmdfY29tcGxldGUoLypyaW5nX3B0cj0qL3JbMV0sIC8qcmVzdWx0X2Zk
PSovMCk7CiAgc3lzY2FsbChfX05SX29wZW4sIC8qZmlsZT0qLzB1bCwKICAgICAgICAgIC8qZmxh
Z3M9X19PX1RNUEZJTEV8T19UUlVOQ3xPX05PTkJMT0NLKi8gMHg0MDBhMDB1bCwKICAgICAgICAg
IC8qbW9kZT1TX0lYR1JQfFNfSVdHUlB8U19JUkdSUCovIDB4Mzh1bCk7CiAgc3lzY2FsbChfX05S
X29wZW4sIC8qZmlsZT0qLzB1bCwgLypmbGFncz1GQVNZTkMqLyAweDIwMDB1bCwKICAgICAgICAg
IC8qbW9kZT1TX0lSVVNSKi8gMHgxMDB1bCk7CiAgc3lzY2FsbChfX05SX3NvY2tldCwgLypkb21h
aW49QUZfQVRNUFZDKi8gOHVsLCAvKnR5cGU9U09DS19QQUNLRVQqLyAweGF1bCwKICAgICAgICAg
IC8qcHJvdG89Ki8weGNmZmIpOwogIHN5c2NhbGwoX19OUl9lcG9sbF9jcmVhdGUxLCAvKmZsYWdz
PUVQT0xMX0NMT0VYRUMqLyAweDgwMDAwdWwpOwogIHN5c2NhbGwoX19OUl9ldmVudGZkMiwgLypp
bml0dmFsPSovMHgxY2YzYzA0MywgLypmbGFncz1FRkRfU0VNQVBIT1JFKi8gMXVsKTsKICBzeXNj
YWxsKF9fTlJfaW9fdXJpbmdfcmVnaXN0ZXIsIC8qZmQ9Ki9yWzBdLCAvKm9wY29kZT0qLzF1bCwg
Lyphcmc9Ki8wdWwsCiAgICAgICAgICAvKm5yX2FyZ3M9Ki8wdWwpOwogIHN5c2NhbGwoX19OUl9j
bG9ja19nZXR0aW1lLCAvKmlkPSovMHVsLCAvKnRwPSovMHVsKTsKICBzeXpfaW9fdXJpbmdfc3Vi
bWl0KC8qcmluZ19wdHI9Ki9yWzFdLCAvKnNxZXNfcHRyPSovclsyXSwgLypzcWU9Ki8wKTsKICBz
eXNjYWxsKF9fTlJfaW9fdXJpbmdfZW50ZXIsIC8qZmQ9Ki9yWzBdLCAvKnRvX3N1Ym1pdD0qLzEs
IC8qbWluX2NvbXBsZXRlPSovMSwKICAgICAgICAgIC8qZmxhZ3M9SU9SSU5HX0VOVEVSX0VYVF9B
Ukd8SU9SSU5HX0VOVEVSX0dFVEVWRU5UUyovIDl1bCwKICAgICAgICAgIC8qc2lnbWFzaz0qLzB1
bCwgLypzaXplPSovMHVsKTsKICBzeXpfaW9fdXJpbmdfY29tcGxldGUoLypyaW5nX3B0cj0qL3Jb
MV0sIC8qcmVzdWx0X2ZkPSovMCk7Cn0KaW50IG1haW4odm9pZCkKewogIHN5c2NhbGwoX19OUl9t
bWFwLCAvKmFkZHI9Ki8weDFmZmZmMDAwdWwsIC8qbGVuPSovMHgxMDAwdWwsIC8qcHJvdD0qLzB1
bCwKICAgICAgICAgIC8qZmxhZ3M9TUFQX0ZJWEVEfE1BUF9BTk9OWU1PVVN8TUFQX1BSSVZBVEUq
LyAweDMydWwsIC8qZmQ9Ki8tMSwKICAgICAgICAgIC8qb2Zmc2V0PSovMHVsKTsKICBzeXNjYWxs
KF9fTlJfbW1hcCwgLyphZGRyPSovMHgyMDAwMDAwMHVsLCAvKmxlbj0qLzB4MTAwMDAwMHVsLAog
ICAgICAgICAgLypwcm90PVBST1RfV1JJVEV8UFJPVF9SRUFEfFBST1RfRVhFQyovIDd1bCwKICAg
ICAgICAgIC8qZmxhZ3M9TUFQX0ZJWEVEfE1BUF9BTk9OWU1PVVN8TUFQX1BSSVZBVEUqLyAweDMy
dWwsIC8qZmQ9Ki8tMSwKICAgICAgICAgIC8qb2Zmc2V0PSovMHVsKTsKICBzeXNjYWxsKF9fTlJf
bW1hcCwgLyphZGRyPSovMHgyMTAwMDAwMHVsLCAvKmxlbj0qLzB4MTAwMHVsLCAvKnByb3Q9Ki8w
dWwsCiAgICAgICAgICAvKmZsYWdzPU1BUF9GSVhFRHxNQVBfQU5PTllNT1VTfE1BUF9QUklWQVRF
Ki8gMHgzMnVsLCAvKmZkPSovLTEsCiAgICAgICAgICAvKm9mZnNldD0qLzB1bCk7CiAgbG9vcCgp
OwogIHJldHVybiAwOwp9
--0000000000007e0948061a4fe5cc--

